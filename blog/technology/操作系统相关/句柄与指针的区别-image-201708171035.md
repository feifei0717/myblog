# [句柄与指针的区别](http://blog.csdn.net/macrossdzh/article/details/4588681)

句柄实际上是一种指向某种资源的指针，但与指针又有所不同：指针对应着一个数据在内存中的地址，得到了指针就可以自由地修改该数据。Windows并不希望一般程序修改其内部[数据结构](http://lib.csdn.net/base/datastructure)，因为这样太不安全。所以Windows给每个使用GlobalAlloc等函数声明的内存区域指定一个句柄(本质上仍是一个指针，但不要直接操作它)，平时你只是在调用API函数时利用这个句柄来说明要操作哪段内存。当你需要对某个内存进行直接操作时，可以使用GlobalLock锁住这段内存并获得指针来直接进行操作。  

“句柄”（handle），handle的本意是把柄，把手的意思。是你与[操作系统](http://lib.csdn.net/base/operatingsystem)打交道的东西。举个例子：比如你做了亏心事（我说的是比如，呵呵），不幸让我抓住了把柄，那么我让你做什么你就得做什么，因为你的把柄在我这。我们编程的时候也是这样，比如我们要想操纵一个窗口，那我们就必须“抓住它的把柄”，只有这样，我们才能改变它的属性，改变它的式样，甚至销毁它（狠了点儿）。我们再引用一个通俗一点的例子，比如你考上了大学，入学后，学校（操作系统）会给你一个学生证号。注意，这个号码是学校指定的，你无法自选。有了这个号码（学生证，假设一证多用）就可以享受学校提供的服务：如你就可以去图书馆借书，去食堂吃饭，去教室上课等等。但你不能到食堂里买啤酒，因为学校不允许这种服务。而在计算机中系统提供的服务就是API调用，你有了HANDLE，就可以理直气壮地向系统提出调用API的服务。而指针的权力就大多了，有了指针你可以到处去喝酒，打架，学校（操作系统）管不着，所以句柄和指针的区别在于句柄只能调用系统提供的服务。而句柄虽然是一个能相互区别的号码，但与我们普通的ID号又有区别，普通的ID号是可以由程序员自己定义的，而句柄不行，它是对象生成时系统指定的，是为了区别系统中存在的各个对象，这个句柄不是由程序员赋给的。实际应用中，最常用的就是文件句柄和窗口句柄。例如，窗口句柄的值是一个长整数，每个窗体都用一个句柄来表示。所以句柄是不会重复的，很多的函数都会用到窗体的句柄。



指针是指向内存中的一个物理地址，直接运行该物理地址的内容；而句柄则是一个四字节的整数（由操作系统管理），windows应用程序靠句柄来找到要引用的对象，但不管权限，什么的，都还是操作系统管理的，应该没错吧。

http://blog.csdn.net/macrossdzh/article/details/4588681





## [指针与句柄的区别](http://www.cnblogs.com/h2-database/archive/2012/06/27/2572498.html)

​    最近两天在复习一些c++的知识，中间发现了许多以前没有注意过的问题。关于句柄以前总是将其理解为指针，其实不然，他们之间有着明显的区别。

​    首先，指针指向系统中物理内存的地址，而句柄是windows在内存中维护的一个对象内存物理地址列表的整数索引，句柄是一种指向指针的指针。

​    在windows系统中的内存管理一般会将当前处于空闲状态的对象的内存释放掉，当需要访问的时候再重新提交分配物理内存，从而导致对象的物理地址是变化的，

这样就不允许系统直接通过指针来访问（物理地址不断变化）的对象。

​    句柄是一种指向指针的指针。由于windows是一种以虚拟内存为基础的操作系统，其内存管理器经常会在内存中来回的移动对象，以此来满足各种应用程序对内存的需求。

而对象的移动意味着对象内存地址的变化，正是因为如此，如果直接使用指针，在内存地址被改变后，系统将不知道到哪里去再调用这个对象。

​    windows系统为论文解决这个问题，系统专门为各种应用程序腾出了一定的**内存地址（句柄）**专门用来记录这些变化的地址（这些内存地址就是指向指针的指针），这些**内存地址**本身是一直不变化的。windows内存管理器在移动某些对象之后，他会将这些对象新的内存地址传给句柄，告诉他移动后对象去了哪里。

​    句柄（稳定的）----->记载着对象在内存中的地址---->对象在内存中的地址（不稳定的）---->记载着实际对象的地址。

![img](image-201708171035/1340769683_5356.jpg)

[图中实线表示初始化的情况，虚线表示在内存管理器处理之后的情况](http://blog.csdn.net/qingtingchen1987)

http://www.cnblogs.com/h2-database/archive/2012/06/27/2572498.html